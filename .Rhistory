install.packages(c("tidyverse", "rticles", "kableExtra", "knitr"))
library(tidyverse)
tinytex::install_tinytex()
Sys.setenv(R_PDFVIEWER = "qpdfview")
Sys.getenv(R_PDFVIEWER)
Sys.getenv("R_PDFVIEWER")
Sys.getenv('HOME')
library(tidyverse)
library(reticulate)
library(tidyverse)
library(reticulate)
library(lubridate)
setwd("~/VegetationMapPaper/")
reticulate::source_python("scripts/plot_phenology.py")
df <- sample_timeseries(n = 10L)
change_names <- function(nums) {
case_when(
nums == 0 ~ "Dwarf Bamboo",
nums == 1 ~ "Other Vegetation",
nums == 2 ~ "No Vegetation",
nums == 3 ~ "Rowans",
nums == 4 ~ "Golden Birch",
nums == 5 ~ "Montane Alder",
nums == 6 ~ "Dwarf Pine"
)
}
df %>%
as_tibble() %>%
mutate(
vegetation = change_names(vegetation),
date = ymd(str_extract(path, "\\d{8}"))
) %>%
select(-path) %>%
pivot_longer(cols = c("R", "G", "B"), names_to = "band", values_to = "value") %>%
write_csv("results/phenology.csv")
df <- read_csv("results/phenology.csv")
p <- df %>%
mutate(band = factor(band, levels = c("R", "G", "B"))) %>%
mutate(id = str_c(index, band)) %>%
mutate(date = as.character(date)) %>%
ggplot() +
geom_line(aes(x = date, y = value, colour = band, group = id)) +
facet_wrap(~ vegetation, nrow = 3) +
labs(
x = "Date",
y = "Pixel Value",
colour = "Band"
) +
theme_minimal() +
theme(
axis.text = element_text(size = 18),
text = element_text(size = 20),
axis.text.x = element_text(angle = 60, hjust = 1),
plot.background = element_rect(fill = "white"),
panel.spacing = grid::unit(2, "lines")
)
p
ggsave("results/phenology.png", plot = p, width = 12, height = 6)
ggsave("results/phenology.png", plot = p, width = 8, height = 8)
ggsave("results/phenology.png", plot = p, width = 10, height = 8)
